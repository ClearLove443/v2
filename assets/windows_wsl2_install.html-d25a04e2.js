import{_ as e,V as s,W as n,a0 as i}from"./framework-7c77a285.js";const l={};function d(r,a){return s(),n("div",null,a[0]||(a[0]=[i(`<h2 id="先决条件" tabindex="-1"><a class="header-anchor" href="#先决条件" aria-hidden="true">#</a> 先决条件</h2><p>必须运行 Windows 10 版本 2004 及更高版本（内部版本 19041 及更高版本）或 Windows 11。 以下命令皆在windows 终端预览版打开</p><p>子系统和本机公用相同端口，要避免端口冲突</p><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装" aria-hidden="true">#</a> 安装</h2><h3 id="启用子系统-powsershell-打开" tabindex="-1"><a class="header-anchor" href="#启用子系统-powsershell-打开" aria-hidden="true">#</a> 启用子系统（powsershell 打开）</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>dism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="列出可用发行版" tabindex="-1"><a class="header-anchor" href="#列出可用发行版" aria-hidden="true">#</a> 列出可用发行版</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">-l</span> <span class="token parameter variable">-o</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="将wsl2设置为默认" tabindex="-1"><a class="header-anchor" href="#将wsl2设置为默认" aria-hidden="true">#</a> 将wsl2设置为默认</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl --set-default-version <span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="cmd-管理员-打开" tabindex="-1"><a class="header-anchor" href="#cmd-管理员-打开" aria-hidden="true">#</a> cmd 管理员 打开</h3><p>启用后 模拟器和vmware都无法使用 VM VirtualBox 可以使用 关闭设置为off 启用虚拟机平台 Windows 功能并确保在 BIOS 中启用虚拟化</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>bcdedit /set hypervisorlaunchtype auto
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="安装-ubuntu-22-04" tabindex="-1"><a class="header-anchor" href="#安装-ubuntu-22-04" aria-hidden="true">#</a> 安装 Ubuntu-22.04</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">--install</span> <span class="token parameter variable">-d</span> Ubuntu-22.04
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="升级-ubuntu-22-04-可选" tabindex="-1"><a class="header-anchor" href="#升级-ubuntu-22-04-可选" aria-hidden="true">#</a> 升级 Ubuntu-22.04 可选</h3><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl.exe --set-version Ubuntu-22.04 <span class="token number">2</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="启动默认发行版" tabindex="-1"><a class="header-anchor" href="#启动默认发行版" aria-hidden="true">#</a> 启动默认发行版</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="启动指定发行版" tabindex="-1"><a class="header-anchor" href="#启动指定发行版" aria-hidden="true">#</a> 启动指定发行版</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">-d</span> Ubuntu-22.04
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="退出" tabindex="-1"><a class="header-anchor" href="#退出" aria-hidden="true">#</a> 退出</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">exit</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="关机所有发行版" tabindex="-1"><a class="header-anchor" href="#关机所有发行版" aria-hidden="true">#</a> 关机所有发行版</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">--shutdown</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="关机指定发行版" tabindex="-1"><a class="header-anchor" href="#关机指定发行版" aria-hidden="true">#</a> 关机指定发行版</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">-t</span> Ubuntu-22.04
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="访问windows-文件" tabindex="-1"><a class="header-anchor" href="#访问windows-文件" aria-hidden="true">#</a> 访问windows 文件</h2><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>ll /mnt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="修改安装目录" tabindex="-1"><a class="header-anchor" href="#修改安装目录" aria-hidden="true">#</a> 修改安装目录</h2><h3 id="使用-wsl" tabindex="-1"><a class="header-anchor" href="#使用-wsl" aria-hidden="true">#</a> 使用 wsl</h3><ul><li>首先查看所有分发版本</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">-l</span> <span class="token parameter variable">--all</span>  <span class="token parameter variable">-v</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>导出分发版为tar文件到d盘</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">--export</span> Ubuntu-22.04 /d/ubuntu22.04.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>wsl --export Ubuntu-22.04 d:\\ubuntu22.04.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>注销指定分发版</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">--unregister</span> Ubuntu-22.04
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>重新导入并安装分发版在d:ubuntu/2204</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>wsl <span class="token parameter variable">--import</span> Ubuntu-22.04 /d/ubuntu/2204 /d/ubuntu22.04.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-cmd line-numbers-mode" data-ext="cmd"><pre class="language-cmd"><code>wsl --import Ubuntu-22.04 d:\\ubuntu\\2204 d:\\ubuntu22.04.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>设置默认登陆用户为安装时用户名</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token string">&#39;/C/Program Files/WindowsApps/CanonicalGroupLimited.ubuntu22.04onWindows_2004.2021.825.0_x64__79rhkp1fndgsc/ubuntu2004.exe&#39;</span> config --default-user ubuntu
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token string">&#39;/C/Program Files/WindowsApps/CanonicalGroupLimited.ubuntu22.04onWindows_2004.2021.825.0_x64__79rhkp1fndgsc/ubuntu2004.exe&#39;</span> config --default-user root
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>删除tar文件(可选)</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rm</span> /d/ubuntu22.04.tar
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="使用lxrunoffline" tabindex="-1"><a class="header-anchor" href="#使用lxrunoffline" aria-hidden="true">#</a> 使用LxRunOffline</h3><ul><li>首先查看所有分发版本</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token string">&#39;/D/Program Files/LxRunOffline/LxRunOffline&#39;</span> list
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>= 查看安装路径</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token string">&#39;/D/Program Files/LxRunOffline/LxRunOffline&#39;</span> get-dir <span class="token parameter variable">-n</span> Ubuntu-22.04
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>子系统迁移</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token string">&#39;/D/Program Files/LxRunOffline/LxRunOffline&#39;</span> move <span class="token parameter variable">-n</span> Ubuntu-22.04 <span class="token parameter variable">-d</span> /d/ubuntu/2204/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查询系统目录，查看是否迁移成功</p><p>如果迁移后查询系统目录仍然在C潘，可以尝试删除子系统再重新下载来重试。</p><h2 id="更换镜像源" tabindex="-1"><a class="header-anchor" href="#更换镜像源" aria-hidden="true">#</a> 更换镜像源</h2><ul><li>备份配置文件</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">cp</span> <span class="token parameter variable">-a</span> /etc/apt/sources.list /etc/apt/sources.list.bak
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>修改sources.list文件</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>将http://archive.ubuntu.com和http://security.ubuntu.com替换成http://192.168.2.10:8081/repository/apt-huawei

<span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s@http://.*archive.ubuntu.com@http://192.168.2.10:8081/repository/apt-huawei/@g&quot;</span> /etc/apt/sources.list
<span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s@http://.*security.ubuntu.com@http://192.168.2.10:8081/repository/apt-huawei/@g&quot;</span> /etc/apt/sources.list
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>更新索引</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">apt-get</span> update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="xshell连接win10-linux子系统" tabindex="-1"><a class="header-anchor" href="#xshell连接win10-linux子系统" aria-hidden="true">#</a> Xshell连接win10 Linux子系统</h2><ul><li>查看ip</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">ifconfig</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ul><li>配置SSH服务</li></ul><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment">## 先删ssh</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> remove <span class="token parameter variable">--purge</span> openssh-server
 <span class="token comment">## 在安装ssh</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> openssh-server
 <span class="token comment">## 删配置文件，让ssh服务自己想办法链接</span>
<span class="token function">sudo</span> <span class="token function">rm</span> /etc/ssh/ssh_config
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">ssh</span> --full-restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>使用Xshell登录 上面命令执行完之后，在xshell中输入用户名和ip就可以通过xshell登录自己电脑的Linux。</li></ul>`,68)]))}const t=e(l,[["render",d],["__file","windows_wsl2_install.html.vue"]]);export{t as default};
