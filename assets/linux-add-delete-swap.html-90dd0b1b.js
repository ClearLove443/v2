import{_ as s,V as e,W as n,a0 as i}from"./framework-e0f7ab62.js";const d={};function l(p,a){return e(),n("div",null,[...a[0]||(a[0]=[i(`<h1 id="简介" tabindex="-1"><a class="header-anchor" href="#简介" aria-hidden="true">#</a> 简介</h1><p>Linux 系统中的 Swap 分区，即交换分区，类似于 Windows 的虚拟内存，其作用可简单的描述为：当系统的物理内存不够用的时候，将暂时不用的数据存放到交换空间所在的硬盘上，从而可以腾出内存来让别的程序运行。 在这里不讨论直接划出一部分硬盘作为交换分区的情况，只介绍通过添加 Swap 文件来设置交换分区的方式。</p><h1 id="添加-swap-文件" tabindex="-1"><a class="header-anchor" href="#添加-swap-文件" aria-hidden="true">#</a> 添加 Swap 文件</h1><p>随便进入一个目录用于后续存放 Swap 文件，也可以直接放在根目录，这里放在 /var 目录下</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> /var
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>使用 dd 命令生成一个文件块，大小为自己想设置的 Swap 分区大小，这里生成一个名为 swapfile 的文件，大小设为 1G。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">dd</span> <span class="token assign-left variable">if</span><span class="token operator">=</span>/dev/zero <span class="token assign-left variable">of</span><span class="token operator">=</span>swapfile <span class="token assign-left variable">bs</span><span class="token operator">=</span>1M <span class="token assign-left variable">count</span><span class="token operator">=</span><span class="token number">1024</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将该文件设为 Swap 文件（格式化）。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mkswap</span> swapfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>另外为了安全建议将交换分区文件权限设为 0600 或 0644 ，执行以下命令。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">chmod</span> 0600 swapfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>激活 Swap 文件（启用虚拟内存）。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">swapon</span> swapfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>检查 Swap 是否正确。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">swapon</span> <span class="token parameter variable">-s</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>此时已经成功添加了交换分区，可以使用 free 之类的命令查看验证。 但这样重启后 Swap 分区会丢失，需要重新激活才行，所以我们一般在 fstab 文件为其添加开机自动挂载设置。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/fstab
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>按<code>i</code>进入编辑模式 在最后增加以下内容：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>/var/swapfile swap swap defaults <span class="token number">0</span> <span class="token number">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>按<code>Esc</code>退出编辑模式 输入<code>:wq</code>保存修改的内容并退出。</p><p>也可以直接执行如下命令来添加：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;/var/swapfile swap swap defaults 0 0&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/fstab
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h1 id="删除-swap-文件" tabindex="-1"><a class="header-anchor" href="#删除-swap-文件" aria-hidden="true">#</a> 删除 Swap 文件</h1><p>这里以我们上面设置的 Swap 文件（文件名、文件路径）作为示范。 首先将 Swap 文件取消激活：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>swapoff /var/swapfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后删除我们设置的 Swap 文件：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">rm</span> /var/swapfile
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>最后再编辑 /fstab 文件删除掉自动挂载 Swap 的设置即可：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vim</span> /etc/fstab
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div>`,29)])])}const c=s(d,[["render",l],["__file","linux-add-delete-swap.html.vue"]]);export{c as default};
