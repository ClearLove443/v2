<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.59" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://clearlove443.github.io.v2/v2/blogs/jenkins/jenkins_gitlab_pipeline.html"><meta property="og:site_name" content="clearlove's blog"><meta property="og:title" content="Create a Jenkins Pipeline with GitLab for Java Projects"><meta property="og:description" content="This post will show you how to configure a Jenkins pipeline that will automatically build your project when you push code to a GitLab repository. We will be using a Jenkinsfile ..."><meta property="og:type" content="article"><meta property="og:updated_time" content="2023-05-21T04:38:09.000Z"><meta property="og:locale" content="en-US"><meta property="article:tag" content="jenkins"><meta property="article:tag" content="gitlab"><meta property="article:tag" content="java"><meta property="article:published_time" content="2021-09-05T18:06:25.000Z"><meta property="article:modified_time" content="2023-05-21T04:38:09.000Z"><title>Create a Jenkins Pipeline with GitLab for Java Projects | clearlove's blog</title><meta name="description" content="This post will show you how to configure a Jenkins pipeline that will automatically build your project when you push code to a GitLab repository. We will be using a Jenkinsfile ...">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/v2/assets/style-db66f5de.css" as="style"><link rel="stylesheet" href="/v2/assets/style-db66f5de.css">
    <link rel="modulepreload" href="/v2/assets/app-ad0cd9ee.js"><link rel="modulepreload" href="/v2/assets/framework-7c77a285.js"><link rel="modulepreload" href="/v2/assets/jenkins_gitlab_pipeline.html-0393718a.js"><link rel="modulepreload" href="/v2/assets/jenkins_gitlab_pipeline.html-302745d9.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><div class="theme-container no-sidebar has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/v2/" class="brand"><img class="logo" src="/v2/profile.png" alt="clearlove&#39;s blog"><!----><span class="site-name hide-in-pad">clearlove&#39;s blog</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/v2/" class="nav-link" aria-label="Home"><span class="icon iconfont icon-home"></span>Home<!----></a></div><div class="nav-item hide-in-mobile"><a href="/v2/zh/demo/" class="nav-link" aria-label="Demo"><span class="icon iconfont icon-discover"></span>Demo<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="V2 Docs" class="nav-link"><span class="icon iconfont icon-note"></span>V2 Docs<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><!----><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><div class="search-pro-button" role="search" aria-label="Search"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg></div><!--]--><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Create a Jenkins Pipeline with GitLab for Java Projects</h1><div class="page-info"><span class="author-info" aria-label="Author🖊" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">Clear Love</span></span><span property="author" content="Clear Love"></span></span><!----><span class="date-info" aria-label="Writing Date📅" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2021-09-05T18:06:25.000Z"></span><span class="category-info" aria-label="Category🌈" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><span class="category-item category0 clickable" role="navigation">deploy</span><meta property="articleSection" content="deploy"></span><span class="tag-info" aria-label="Tag🏷" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><span class="tag-item tag-item6 clickable" role="navigation">jenkins</span><span class="tag-item tag-item4 clickable" role="navigation">gitlab</span><span class="tag-item tag-item6 clickable" role="navigation">java</span><meta property="keywords" content="jenkins,gitlab,java"></span><span class="reading-time-info" aria-label="Reading Time⌛" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 6 min</span><meta property="timeRequired" content="PT6M"></span></div><hr></div><!----><!----><div class="theme-hope-content"><p>This post will show you how to configure a Jenkins pipeline that will automatically build your project when you push code to a GitLab repository. We will be using a Jenkinsfile to define our pipeline, which is best practice. Here’s the workflow: Push to GitLab → Jenkins pipeline triggered → Run build (Maven) → Run JUnit tests (Maven) → Email result from pipeline If you don’t already have GitLab and Jenkins installed, you can follow the instructions in this post and then come back here. This post also assumes you have Java, Git, and Maven installed, along with a simple Maven project with at least one JUnit test. Make sure you’re able to successfully run mvn clean install and mvn test on your project before following along.</p><figure><img src="/v2/1_zxRWg_D0NSuRYD38rX64AA.png" alt="Jenkins Pipe1" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe1</figcaption></figure><h1 id="step-1-create-a-gitlab-repository" tabindex="-1"><a class="header-anchor" href="#step-1-create-a-gitlab-repository" aria-hidden="true">#</a> Step 1: Create a GitLab Repository</h1><p>In GitLab, create a group by clicking on the Groups dropdown and then clicking the New group button. Give your group a name and then click Create group.</p><figure><img src="/v2/1_RGqRiQAh0oldwqAErdhASw.png" alt="Jenkins Pipe2" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe2</figcaption></figure><p>Create a new project by clicking New project. Give it a name and click Create project.</p><figure><img src="/v2/1_B_2gzjgzVCdWZhCtHEK6-Q.png" alt="Jenkins Pipe3" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe3</figcaption></figure><p>Initialize your local Maven project and push it to your new repository:</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> existing_folder
<span class="token function">git</span> init
<span class="token function">git</span> remote <span class="token function">add</span> origin http://localhost/my-group/my-project.git
<span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">&quot;Initial commit&quot;</span>
<span class="token function">git</span> push <span class="token parameter variable">-u</span> origin master
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Refresh your project in GitLab and you should see your code. If you see a banner saying “The Auto DevOps pipeline has been enabled…” go into settings and disable it.</p><h1 id="step-2-create-a-jenkins-user-in-gitlab" tabindex="-1"><a class="header-anchor" href="#step-2-create-a-jenkins-user-in-gitlab" aria-hidden="true">#</a> Step 2: Create a Jenkins User in GitLab</h1><p>We need to create a Jenkins user in GitLab so that Jenkins can communicate with GitLab’s API via the plugin we will install in Step 4. In GitLab, go to the Admin Area by clicking on the wrench icon in the top toolbar.</p><p>In the left menu, click on Users and then click New user at the top right hand corner. Fill out the required fields appropriately and make sure to select the Admin radio button under Access level:</p><figure><img src="/v2/1_ZRTdQCBRsiXHW1sB8WZM5Q.png" alt="Jenkins Pipe4" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe4</figcaption></figure><p>Go back to the Users page and edit the Jenkins user you just created. Give the user a password so that you can log in as that user. Once you’ve done this, log out of your current session and log in as the Jenkins user. Once logged in as the Jenkins user, go to your settings and click Access Tokens in the left menu bar. Make sure to give your token a name and select api under Scopes.</p><figure><img src="/v2/1_Cau3JzuTX5cKYSlwmg41QA.png" alt="Jenkins Pipe5" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe5</figcaption></figure><p>Once you have created the access token, copy and paste the token somewhere temporarily — you will not be able to access it from here again. We will use this token later. Log out and log back in as the root user.</p><h1 id="step-3-create-a-gitlab-user-in-jenkins" tabindex="-1"><a class="header-anchor" href="#step-3-create-a-gitlab-user-in-jenkins" aria-hidden="true">#</a> Step 3: Create a GitLab User in Jenkins</h1><p>Now, we need to create a GitLab user in Jenkins so that GitLab can notify Jenkins of updates to the repository via webhooks. From the Jenkins homepage, go to Manage Jenkins → Manage Users → Create User and fill in the form.</p><figure><img src="/v2/1_h6iPjC-4b7Kbk30csafyeA.png" alt="Jenkins Pipe6" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe6</figcaption></figure><p>After creating the user, log out and log back in as the “gitlab” user. Go to Manage Jenkins → Manage Users and click on the gear icon next to the gitlab user to configure it. Under API Token, click Add new Token and give it a name, then click Generate.</p><figure><img src="/v2/1_aq0KlMJPnYDkPMCz_Ul-1w.png" alt="Jenkins Pipe7" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe7</figcaption></figure><p>Once you have generated the token, copy and paste the token somewhere temporarily — you will not be able to access it from here again. We will use this token later. Log out and log back in as the admin user.</p><h1 id="step-4-install-and-configure-gitlab-plugin-for-jenkins" tabindex="-1"><a class="header-anchor" href="#step-4-install-and-configure-gitlab-plugin-for-jenkins" aria-hidden="true">#</a> Step 4: Install and Configure GitLab Plugin for Jenkins</h1><p>We need to install the GitLab plugin for Jenkins so that they can communicate with each other. On the Jenkins homepage, click on Manage Jenkins → Manage Plugins. Click on the Available tab and search for “gitlab” and install the GitLab plugin.</p><figure><img src="/v2/1_DmXrE5yjMZZRnoMuEsdwNQ.png" alt="Jenkins Pipe8" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe8</figcaption></figure><p>Check the box for “Restart Jenkins when installation is complete…” If you miss this, you can also restart Jenkins with sudo <code>systemctl restart jenkins</code> after the download has finished.</p><figure><img src="/v2/1_q3H7M4GTq7Cz8uA4wvohfg.jpeg" alt="Jenkins Pipe9" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe9</figcaption></figure><p>After about a minute, refresh the page and log back in as the admin user again. In Jenkins, go to Manage Jenkins → Configure System and scroll down to the Gitlab section. Enter in a name for the connection, the URL to your GitLab instance, and then next to Credentials, click Add → Jenkins. This is where you will add your GitLab token from Step 2.</p><figure><img src="/v2/1_5wBEBvOFM8umC9uuhgP-Cw.png" alt="Jenkins Pipe10" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe10</figcaption></figure><p>Next to Kind, select GitLab API Token. Paste your GitLab API token and give it an ID and a description, and click Add to add the token to Jenkins:</p><figure><img src="/v2/1_3G72OilRB69NSCQwPEb6jw.png" alt="Jenkins Pipe11" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe11</figcaption></figure><p>Click the dropdown next to Credentials and select the token. Then click Test Connection — you should see “Success” afterward:</p><figure><img src="/v2/1_fTE2XG_QkAMoIxGwL-9J0Q.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Click Save at the bottom of the screen to save your changes. You can view your newly created credential at Manage Jenkins → Credentials. Now Jenkins is ready to communicate with the GitLab API.</p><h1 id="step-5-create-a-jenkins-pipeline" tabindex="-1"><a class="header-anchor" href="#step-5-create-a-jenkins-pipeline" aria-hidden="true">#</a> Step 5: Create a Jenkins Pipeline</h1><p>On the Jenkins homepage, click New Item in the left menu bar. Enter the name for the item and select Pipeline. Click OK to create it:</p><figure><img src="/v2/1_SGIwwmgJF7ZadvlRXGO1mA.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>The next thing you will see is the pipeline configuration page. Check the box for Discard old builds and set Max # of builds to keep to a reasonable number (I chose 3 for this tutorial):</p><figure><img src="/v2/1_c7fZWOIzruYaFXUT9ZHWzg.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Ensure that the connection you created in Step 4 is selected next to GitLab Connection:</p><figure><img src="/v2/1_DOCwZJYBHhA9XvGlfcQEEA.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Under the Build Triggers section, check the box for Build when a change is pushed to GitLab and copy the GitLab webhook URL next to it for later. Leave the Enabled GitLab triggers section unchanged:</p><figure><img src="/v2/1_xHMNSRGy0l8MV6B2P2nckQ.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Under the Pipeline section, select Pipeline script from SCM from the Definition dropdown (this will be the Jenkinsfile described later) and select Git from the SCM dropdown. Enter the repository URL (same as what you use for git clone). You should see an authentication error because we haven’t provided a username/password that can access your GitLab repository yet:</p><figure><img src="/v2/1_4WshKFBNdq80y_LiyDR3Sw.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Next to Credentials, click Add → Jenkins and fill in your GitLab username/password and click Add:</p><figure><img src="/v2/1_P7PEcXWUKYuDBydgsaiESg.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Select your credential from the Credentials dropdown and the authentication error should go away. If it doesn’t, ensure you have the right username/password and that the user has access rights to the repository.</p><figure><img src="/v2/1_p8d96s1Qo2PQpeI0QKXOPA.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Click Save at the bottom of the screen.</p><h1 id="step-6-configure-a-webhook-in-gitlab" tabindex="-1"><a class="header-anchor" href="#step-6-configure-a-webhook-in-gitlab" aria-hidden="true">#</a> Step 6: Configure a Webhook in GitLab</h1><p>We need a way for GitLab to tell Jenkins when code has been pushed to a repository — this is what webhooks are for. NOTE: If your Jenkins instance is running on localhost, follow these steps to allow GitLab to send requests locally: Go to the Admin Area Hover over Settings and click Network Expand Outbound requests Check the box for Allow requests to the local network from web hooks and services Click Save changes In GitLab, go to your project and then hover over Settings at the bottom of the left menu bar, then click on Webhooks. Enter in the URL to your Jenkins pipeline (the one you copied from the last step) and modify it so that it follows this scheme:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>http://&lt;gitlab-user-in-jenkins&gt;:&lt;token&gt;@&lt;host&gt;/project/&lt;project-name&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Leave the Secret Token field blank and ensure that Push events is checked.</p><figure><img src="/v2/1_X7BK7kbAEh1Mncne14DOVw.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Click Add webhook and then scroll down to the bottom to see your webhook. Test it by clicking Test → Push events. You should see a 200 status code:</p><p>If you go back to Jenkins, you should see a failed build — this is good news because it means that the webhook worked, and that Jenkins is able to listen for pushes to your GitLab repository. If you inspect the Jenkins build console output, you will see something similar to this error:</p><figure><img src="/v2/1_T2h9N3QMq5vaUraeIzeb4w.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><h1 id="step-7-add-a-jenkinsfile" tabindex="-1"><a class="header-anchor" href="#step-7-add-a-jenkinsfile" aria-hidden="true">#</a> Step 7: Add a Jenkinsfile</h1><p>Inside your git repository, create a file named “Jenkinsfile” at the root level. Paste the following into your Jenkinsfile and push it to your repository:</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pipeline {
    agent any

    stages {
        stage(&#39;Build&#39;) {
            steps {
                sh &#39;mvn clean install -DskipTests&#39;
            }
        }
        stage(&#39;Test&#39;) {
            steps {
                sh &#39;mvn test&#39;
            }
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This Jenkinsfile is telling Jenkins to split the build up into stages — first a “Build” stage that builds our Maven project and then a “Test” stage that runs our JUnit tests through Maven. Assuming you have Maven installed and configured on the same machine that Jenkins is running on, you should see something like the following when you view your pipeline project in Jenkins:</p><figure><img src="/v2/1_Omr8diPglypKPE07GUjkwQ.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>If you see a red rectangle instead of a green one in the Build or Test stages, it means that either your code failed to build or one of your unit tests failed. You can inspect the entire process by clicking on the build in the Build History section and then clicking on Console Output.</p><figure><img src="/v2/1_lqHfBc-DN4_Jl0b7Gw-reA.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><h1 id="step-8-email-notifications" tabindex="-1"><a class="header-anchor" href="#step-8-email-notifications" aria-hidden="true">#</a> Step 8: Email Notifications</h1><p>It is common practice to have the pipeline send an email to the user who pushed their code to let them know whether their build passed or failed. If you don’t already have “Email Extension Plugin” installed, install that plugin before continuing. NOTE: Make sure the GitLab account you are pushing from has a valid email address — this is the address your pipeline will send an email to. Configure the plugin by going to Manage Jenkins → Configure System and scrolling down to Extended E-mail Notification. Fill in your SMTP server, click Advanced… and check the box for Use SMTP Authentication. Fill in your username (email address) and password, then check the box for Use SSL. Enter 465 for the SMTP port:</p><figure><img src="/v2/1_7Y1uLCVr-dX6TyzHlJTuXw.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Scroll back up to the top, and under Jenkins Location, change the System Admin e-mail address to “Jenkins <a href="mailto:jenkins@jenkins">jenkins@jenkins</a>” — this will appear as the sender name in the email you will receive.</p><figure><img src="/v2/1_d6_i2skZkr7y-CWZYE7PHw.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Click Save at the bottom. In your Jenkinsfile, add the following “post” section after the “stages” section and push it to your repository.</p><figure><img src="/v2/1_d6_i2skZkr7y-CWZYE7PHw.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>pipeline {
    agent any

    stages {
        stage(&#39;Build&#39;) {
            steps {
                sh &#39;mvn clean install -DskipTests&#39;
            }
        }
        stage(&#39;Test&#39;) {
            steps {
                sh &#39;mvn test&#39;
            }
        }
    }

    post {
        always {
            emailext subject: &quot;Jenkins Build ${currentBuild.currentResult}: Job \&quot;${env.JOB_NAME}\&quot;&quot;,
                body: &quot;${currentBuild.currentResult}: Job \&quot;${env.JOB_NAME}\&quot; build ${env.BUILD_NUMBER}.\nMore info at: ${env.BUILD_URL}&quot;,
                recipientProviders: [[$class: &#39;DevelopersRecipientProvider&#39;], [$class: &#39;RequesterRecipientProvider&#39;]]
        }
    }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Here, we’re telling Jenkins to always send an email to the user after the build completes, and giving it a template for how to display the information. Go back to your Jenkins pipeline to see it running. If all went well, you should see something similar to the following and should have also received an email.</p><figure><img src="/v2/1_V3nwYMmky_tN7yg-42x5yQ.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><figure><img src="/v2/1_cbi7Auiu-Ni4L15NHuIRBA.png" alt="Jenkins Pipe12" tabindex="0" loading="lazy"><figcaption>Jenkins Pipe12</figcaption></figure><p>Congratulations! You have successfully set up a Jenkins pipeline to automatically build Java projects from GitLab.</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/vuepress-theme-hope/vuepress-theme-hope/edit/main/docs/blogs/jenkins/jenkins_gitlab_pipeline.md" rel="noopener noreferrer" target="_blank" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]--><!----><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">Last update: </span><!----></div><div class="meta-item contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: 1127280933@qq.com">ClearLove443</span><!--]--><!--]--></div></footer><!----><!----><!----><!--]--></main><!--]--><!----><!--]--></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/v2/assets/app-ad0cd9ee.js" defer></script>
  </body>
</html>
